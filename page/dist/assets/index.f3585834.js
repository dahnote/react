import{Q as z}from"./QInput.3afb05c8.js";import{ar as A,r as c,f as _,o as M,q as u,as as m,k as r,p as n,s as d,x as b,cw as K,z as f,v as $,y as k,A as L,av as N,aM as q,F as H}from"./index.fb3f5ad5.js";import{Q as U}from"./QCardSection.4591ffd9.js";import{Q as j}from"./QCard.2b2d4094.js";import{Q as G}from"./QTd.417aa865.js";import{l as O,n as R,Q as W}from"./no-data.2e8b8955.js";import{u as J}from"./permission.2824d1cc.js";import{a as w}from"./axios.a0958352.js";import{f as X}from"./table-filter.7923a56f.js";import{n as Y}from"./notify.71f93eb9.js";import{b as Z}from"./format-time.e227a64b.js";import{u as ee}from"./vue-i18n.runtime.f4bab15f.js";import"./use-timeout.6c0c86b6.js";import"./uid.42677368.js";import"./use-transition.97bade2a.js";import"./QSeparator.9cedb50e.js";import"./QList.e0faa10e.js";import"./QSelect.650daa0f.js";import"./QMenu.0d0ddedc.js";import"./position-engine.d6f8c41b.js";import"./selection.2af613b2.js";import"./use-portal.7095234a.js";import"./focusout.c6764dff.js";import"./QDialog.fc5c29ed.js";import"./rtl.b51694b1.js";import"./format.c860d4da.js";import"./QInnerLoading.4e21fbf1.js";const ae=()=>w.get("/api/iservcloud2/resources/vms"),le=()=>w.get("/api/iservcloud2/link");const te={class:"row q-col-gutter-md"},oe={class:"col-12 col-sm-5"},se={class:"col-12 col-sm-7 row items-end"},re={key:0,class:"mb-4 row justify-end"},ne={key:1,class:"null-h52-block"},ie={key:0,class:"text-green-8"},ue={key:1,class:"text-grey-8"},me={key:0,class:"ma-10 pa-10"},o="resource.iservcloud.vm",de={__name:"index",setup(ce){const{t,te:I}=ee(),F=J(),i=c(!0),S=_(()=>[{name:"name",align:"left",label:t(`${o}.name`),field:"vm_name",headerClasses:"table-header",classes:"table-body"},{name:"source",align:"left",label:t(`${o}.source`),field:"uiFormatSource",headerClasses:"table-header",classes:"table-body"},{name:"specs",align:"left",label:t(`${o}.specs`),field:"uiFormatSpecs",headerClasses:"table-header",classes:"table-body"},{name:"uiFormatExternalIP",align:"left",label:t(`${o}.externalIP`),field:"uiFormatExternalIP",headerClasses:"table-header",classes:"table-body",sortable:!0},{name:"uiFormatInternalIP",align:"left",label:t(`${o}.internalIP`),field:"uiFormatInternalIP",headerClasses:"table-header",classes:"table-body",sortable:!0},{name:"keypair",align:"left",label:t(`${o}.keypair`),field:"keypair",headerClasses:"table-header",classes:"table-body"},{name:"formatExpiration",align:"left",label:t(`${o}.expiration`),field:"formatExpiration",headerClasses:"table-header",classes:"table-body",sortable:!0},{name:"state",align:"left",label:t(`${o}.state`),field:"uiFormatStateI18n",headerClasses:"table-header",classes:"table-body"}]),C={rowsPerPage:10,sortBy:"",descending:!0},P=[0,10,20],p=c(""),g=c(""),h=()=>{g.value=p.value,l.value=[],y()},Q=()=>{p.value="",B.value="all"},B=c("all"),E=(e,a,s)=>X(s,e,a),V=_(()=>(l.value.forEach((e,a)=>{const s=e.disk/1073741824;e.image.length===0?(l.value[a].uiFormatSource=`${t(`${o}.volume`)} (${e.bootVolume.name})`,l.value[a].uiFormatSpecs=`${e.cpu}${t(`${o}.core`)} ${e.ram}MB ${e.bootVolume.size}`):(l.value[a].uiFormatSource=`${t(`${o}.img`)} (${e.image})`,l.value[a].uiFormatSpecs=`${e.cpu}${t(`${o}.core`)} ${e.ram}MB ${s}GB`),e.publicip.length===0?l.value[a].uiFormatExternalIP="":l.value[a].uiFormatExternalIP=`${e.publicip[0]}`,e.private_ip.length===0?l.value[a].uiFormatInternalIP="":l.value[a].uiFormatInternalIP=`${e.private_ip[0]}`,e.vm_status.length===0?l.value[a].uiFormatStateI18n="":l.value[a].uiFormatStateI18n=I(`${o}.${e.vm_status}`)?t(`${o}.${e.vm_status}`):e.vm_status,l.value[a].formatExpiration=Z(e.vm_end)}),l.value)),l=c([]),y=()=>{i.value=!0,ae().then(e=>{l.value=e.data}).catch(()=>{Y("error",t("resource.iservcloud.failed2Api"))}).finally(()=>{i.value=!1})};let v="";const x=()=>{le().then(e=>{v=e.data.url_link})},D=()=>!!(l.value.length===0&&i.value),T=()=>{window.open(v,"_blank")};return y(),x(),M(()=>{}),(e,a)=>(u(),m(H,null,[r(j,{class:"bg-grey-11 shadow-1 mb-4 text-weight-medium"},{default:n(()=>[r(U,null,{default:n(()=>[d("div",te,[d("div",oe,[d("div",null,b(e.$t("general.table.keyword")),1),r(z,{dense:"",placeholder:e.$t("general.table.enterKeyword"),modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=s=>p.value=s),onKeyup:a[1]||(a[1]=K(s=>h(),["enter"]))},null,8,["placeholder","modelValue"])]),d("div",se,[r(f,{class:"mr-2",color:"primary",icon:"mdi-magnify",label:e.$t("general.btn.search"),onClick:a[2]||(a[2]=s=>h()),rounded:"","no-caps":""},null,8,["label"]),r(f,{color:"secondary",icon:"mdi-eraser",label:e.$t("general.btn.reset"),onClick:a[3]||(a[3]=s=>Q()),rounded:"","no-caps":""},null,8,["label"])])])]),_:1})]),_:1}),$(F).role==="supervisor"?(u(),m("div",re,[r(f,{class:"",color:"accent",icon:"mdi-cloud-sync-outline",label:e.$t("general.btn.toiServCloud"),onClick:a[4]||(a[4]=s=>T()),rounded:"","no-caps":"",disable:$(v)===""},null,8,["label","disable"])])):(u(),m("div",ne)),r(W,{"card-class":"customer-table",rows:V.value,columns:S.value,"row-key":"id",loading:i.value,"loading-label":" ","hide-bottom":D(),pagination:C,"rows-per-page-options":P,filter:g.value,"filter-method":E},{"body-cell-state":n(s=>[r(G,{class:"table-body"},{default:n(()=>[s.row.vm_status==="Active"?(u(),m("div",ie,[r(k,{size:"24px",name:"mdi-check-circle-outline"}),d("span",null,b(s.row.uiFormatStateI18n),1)])):(u(),m("div",ue,[r(k,{size:"24px",name:"mdi-minus-circle-outline"}),d("span",null,b(s.row.uiFormatStateI18n),1)]))]),_:2},1024)]),loading:n(()=>[L(r(O,null,null,512),[[N,i.value]])]),"bottom-row":n(()=>[i.value&&l.value.length===0?(u(),m("div",me)):q("",!0)]),"no-data":n(()=>[r(R)]),_:1},8,["rows","columns","loading","hide-bottom","filter"])],64))}};var Le=A(de,[["__scopeId","data-v-490ea729"]]);export{Le as default};
