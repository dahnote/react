import{Q as S}from"./QInput.3afb05c8.js";import{r as c,q as V,n as R,p as u,k as l,s as r,x as k,z as g,ar as O,f as C,o as W,as as U,cw as H,A as B,av as J,aM as P,F as X}from"./index.fb3f5ad5.js";import{Q as j}from"./QCardActions.5afa793e.js";import{d as b,Q as Z,a as ee}from"./QPopupProxy.c8c25096.js";import{Q as q}from"./QCardSection.4591ffd9.js";import{Q as I}from"./QCard.2b2d4094.js";import{c as y,n as ae,Q as le,l as te}from"./no-data.2e8b8955.js";import{C as oe}from"./ClosePopup.74952a98.js";import{p as se,a as ne}from"./system-mgmt.2f88f3a8.js";import{f as re}from"./table-filter.7923a56f.js";import{c as ue}from"./format-time.e227a64b.js";import{Q as ie}from"./QForm.9a518ac8.js";import{Q as de}from"./QDialog.fc5c29ed.js";import{n as Q}from"./notify.71f93eb9.js";import{u as A}from"./vue-i18n.runtime.f4bab15f.js";import"./use-timeout.6c0c86b6.js";import"./uid.42677368.js";import"./use-transition.97bade2a.js";import"./use-cache.b0833c75.js";import"./format.c860d4da.js";import"./QMenu.0d0ddedc.js";import"./position-engine.d6f8c41b.js";import"./selection.2af613b2.js";import"./use-portal.7095234a.js";import"./focusout.c6764dff.js";import"./QSeparator.9cedb50e.js";import"./QList.e0faa10e.js";import"./QSelect.650daa0f.js";import"./rtl.b51694b1.js";import"./QInnerLoading.4e21fbf1.js";import"./axios.a0958352.js";const ce={class:"text-h6"},fe={class:"q-gutter-y-xs q-col-gutter-x-md row"},me={class:"col-4"},pe={class:"col-4"},ve={class:"col-4"},be={class:"col-4"},_e={class:"col-8"},T="system.report",ge={__name:"operate",emits:["success"],setup(K,{expose:w,emit:m}){const{t:_}=A(),Y=c(null),v=c(!1),f=c(!1),s=c({conf_ec2:!1,conf_ebs:!1,conf_vpc:!1,conf_subnets:!1,conf_security_groups:!1}),h=e=>{s.value={conf_ec2:e.value.conf_ec2,conf_ebs:e.value.conf_ebs,conf_vpc:e.value.conf_vpc,conf_subnets:e.value.conf_subnets,conf_security_groups:e.value.conf_security_groups},v.value=!0},D=m,$=async()=>{let e=!1;if((s.value.conf_ec2||s.value.conf_ebs||s.value.conf_security_groups||s.value.conf_subnets||s.value.conf_vpc)&&(e=!0),e){f.value=!0;const o=s.value;se(o).then(n=>{v.value=!1,Q("success",_("general.form.notify.successfullyEdited")),D("success")}).catch(n=>{Q("error",_("general.form.notify.failed2Edit"),n.response.data.detail)}).finally(()=>{f.value=!1})}else Q("error",_("general.form.notify.failed2Edit"),_(`${T}.selectError`))};return w({openEdit:h}),(e,o)=>(V(),R(de,{modelValue:v.value,"onUpdate:modelValue":o[7]||(o[7]=n=>v.value=n),persistent:""},{default:u(()=>[l(I,{style:{"min-width":"280px"}},{default:u(()=>[l(q,null,{default:u(()=>[r("div",ce,[r("span",null,k(e.$t(`${T}.edit`)),1)]),l(ie,{ref_key:"pageform",ref:Y,greedy:""},{default:u(()=>[r("div",fe,[r("div",me,[l(y,{modelValue:s.value.conf_ec2,"onUpdate:modelValue":o[0]||(o[0]=n=>s.value.conf_ec2=n),label:"EC2",color:"teal",class:"text-body1 text-weight-bold"},null,8,["modelValue"])]),r("div",pe,[l(y,{modelValue:s.value.conf_ebs,"onUpdate:modelValue":o[1]||(o[1]=n=>s.value.conf_ebs=n),label:"EBS",color:"teal",class:"text-body1 text-weight-bold"},null,8,["modelValue"])]),r("div",ve,[l(y,{modelValue:s.value.conf_vpc,"onUpdate:modelValue":o[2]||(o[2]=n=>s.value.conf_vpc=n),label:"VPC",color:"teal",class:"text-body1 text-weight-bold"},null,8,["modelValue"])]),r("div",be,[l(y,{modelValue:s.value.conf_subnets,"onUpdate:modelValue":o[3]||(o[3]=n=>s.value.conf_subnets=n),label:"Subnets",color:"teal",class:"text-body1 text-weight-bold"},null,8,["modelValue"])]),r("div",_e,[l(y,{modelValue:s.value.conf_security_groups,"onUpdate:modelValue":o[4]||(o[4]=n=>s.value.conf_security_groups=n),label:"Security Groups",color:"teal",class:"text-body1 text-weight-bold"},null,8,["modelValue"])])])]),_:1},512)]),_:1}),l(j,{align:"center"},{default:u(()=>[l(g,{color:"secondary",rounded:"",label:e.$t("general.btn.cancel"),disable:f.value,onClick:o[5]||(o[5]=n=>v.value=!1),"no-caps":""},null,8,["label","disable"]),l(g,{color:"accent",rounded:"",label:e.$t("general.btn.edit"),loading:f.value,onClick:o[6]||(o[6]=n=>$()),"no-caps":""},null,8,["label","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};const ye={class:"row q-col-gutter-md"},he={class:"col-12 col-sm-4"},De={class:"col-12 col-sm-4"},$e={class:"col-12 col-sm-8 row justify-center"},Ve={class:"mb-4 row justify-end"},we={key:0,class:"ma-10 pa-10"},F="system.report",Ye={__name:"index",setup(K){const{t:w}=A(),m=c(!0),_=C(()=>{const t=[{name:"updateTime",align:"left",label:w(`${F}.updateTime`),field:"formatUpdateTime",headerClasses:"table-header",classes:"table-body",sortable:!0,filter:!1}];return d.value.conf_ec2&&t.push({name:"ec2",align:"left",label:"EC2",field:"ec2",headerClasses:"table-header",classes:"table-body",sortable:!0}),d.value.conf_ebs&&t.push({name:"ebs",align:"left",label:"EBS",field:"ebs",headerClasses:"table-header",classes:"table-body",sortable:!0}),d.value.conf_vpc&&t.push({name:"vpc",align:"left",label:"VPC",field:"vpc",headerClasses:"table-header",classes:"table-body",sortable:!0}),d.value.conf_subnets&&t.push({name:"subnets",align:"left",label:"Subnets",field:"subnets",headerClasses:"table-header",classes:"table-body",sortable:!0}),d.value.conf_security_groups&&t.push({name:"security_groups",align:"left",label:"Security Groups",field:"security_groups",headerClasses:"table-header",classes:"table-body",sortable:!0}),t}),Y={rowsPerPage:10,sortBy:"updateTime",descending:!0},v=[0,10,20],f=c(""),s=c(""),h=Date.now(),D=b.formatDate(b.subtractFromDate(h,{days:7}),"YYYY/MM/DD"),$=b.formatDate(h,"YYYY/MM/DD"),e=c({from:D,to:$}),o=()=>{s.value=f.value,p.value=[],M()},n=()=>{f.value="",e.value={from:D,to:$}},x=C(()=>e.value!==null?typeof e.value=="object"?`${e.value.from}~${e.value.to}`:`${e.value}~${e.value}`:""),N=(t,a,i)=>re(i,t,a),G=C(()=>(p.value.forEach((t,a)=>{p.value[a].formatUpdateTime=ue(t.date)}),p.value)),p=c([]),d=c({conf_ec2:!1,conf_ebs:!1,conf_vpc:!1,conf_subnets:!1,conf_security_groups:!1}),M=()=>{m.value=!0;let t="";e.value===null?t="":typeof e.value=="object"?t=`?date_from=${b.formatDate(e.value.from,"YYYY-MM-DD")}&date_end=${b.formatDate(e.value.to,"YYYY-MM-DD")}`:t=`?date_from=${b.formatDate(e.value,"YYYY-MM-DD")}&date_end=${b.formatDate(e.value,"YYYY-MM-DD")}`,ne(t).then(a=>{p.value=a.data.data_content,d.value.conf_ec2=a.data.subscript_settings.conf_ec2,d.value.conf_ebs=a.data.subscript_settings.conf_ebs,d.value.conf_security_groups=a.data.subscript_settings.conf_security_groups,d.value.conf_subnets=a.data.subscript_settings.conf_subnets,d.value.conf_vpc=a.data.subscript_settings.conf_vpc}).finally(()=>{m.value=!1})},L=()=>!!(p.value.length===0&&m.value),E=c(null),z=()=>{E.value.openEdit(d)};return M(),W(()=>{}),(t,a)=>(V(),U(X,null,[l(I,{class:"bg-grey-11 shadow-1 mb-4 text-weight-medium"},{default:u(()=>[l(q,null,{default:u(()=>[r("div",ye,[r("div",he,[r("div",null,k(t.$t("general.table.keyword")),1),l(S,{dense:"",placeholder:t.$t("general.table.enterKeyword"),modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=i=>f.value=i),onKeyup:a[1]||(a[1]=H(i=>o(),["enter"]))},null,8,["placeholder","modelValue"])]),r("div",De,[r("div",null,k(t.$t("general.table.dateRange")),1),l(S,{dense:"",readonly:"",class:"cursor-pointer",modelValue:x.value,"onUpdate:modelValue":a[3]||(a[3]=i=>x.value=i)},{default:u(()=>[l(Z,{"transition-show":"scale","transition-hide":"scale",class:"s123"},{default:u(()=>[l(ee,{minimal:"",modelValue:e.value,"onUpdate:modelValue":a[2]||(a[2]=i=>e.value=i),mask:"YYYY/MM/DD",range:""},{default:u(()=>[l(j,{class:"q-pa-none",align:"around"},{default:u(()=>[B(l(g,{color:"secondary",label:t.$t("general.btn.close")},null,8,["label"]),[[oe]])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),r("div",$e,[l(g,{class:"mr-2",color:"primary",icon:"mdi-magnify",label:t.$t("general.btn.search"),onClick:a[4]||(a[4]=i=>o()),rounded:"","no-caps":""},null,8,["label"]),l(g,{color:"secondary",icon:"mdi-eraser",label:t.$t("general.btn.reset"),onClick:a[5]||(a[5]=i=>n()),rounded:"","no-caps":""},null,8,["label"])])])]),_:1})]),_:1}),r("div",Ve,[l(g,{class:"mr-2",color:"accent",label:t.$t(`${F}.edit`),onClick:a[6]||(a[6]=i=>z()),rounded:"","no-caps":""},null,8,["label"])]),l(le,{"card-class":"customer-table",rows:G.value,columns:_.value,"row-key":"id",loading:m.value,"loading-label":" ","hide-bottom":L(),pagination:Y,"rows-per-page-options":v,filter:s.value,"filter-method":N},{loading:u(()=>[p.value.length===0?B((V(),R(te,{key:0},null,512)),[[J,m.value]]):P("",!0)]),"bottom-row":u(()=>[m.value&&p.value.length===0?(V(),U("div",we)):P("",!0)]),"no-data":u(()=>[l(ae)]),_:1},8,["rows","columns","loading","hide-bottom","filter"]),l(ge,{ref_key:"operateDialogRef",ref:E,onSuccess:a[7]||(a[7]=i=>o())},null,512)],64))}};var ta=O(Ye,[["__scopeId","data-v-282a2416"]]);export{ta as default};
