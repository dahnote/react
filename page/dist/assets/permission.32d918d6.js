import{b as m,m as l}from"./index.fb3f5ad5.js";import{g as p}from"./axios.a0958352.js";import{u as f}from"./permission.2824d1cc.js";import{g as n}from"./get-web-title.3c0fc212.js";import"./i18n.3104a583.js";import"./user.1bd09781.js";import"./vue-i18n.runtime.f4bab15f.js";const r=["/login","/404"],s=f();var w=m(({router:t})=>{t.beforeEach(async(o,h,e)=>{o.meta.title&&(document.title=n(o.meta.title));const a=p();if(a)try{s.role===""?await s.checkToken(a)!=="error"?((await s.addRoute(l)).forEach(c=>{t.addRoute(c)}),e({...o,replace:!0})):e({path:"/login"}):r.indexOf(o.path)!==-1||o.path==="/"?e({path:"/dashboard"}):e()}catch(i){console.log(i),e()}else r.indexOf(o.path)!==-1?e():e({path:"/login"})})});export{w as default};
