import{Q as O}from"./QCardSection.4591ffd9.js";import{Q as P}from"./QCard.2b2d4094.js";import{C as Te,r as y,f as V,w as H,D as te,ag as ae,af as se,aa as Pe,h as oe,E as je,g as Be,G as Ve,Y as Ae,ar as Y,q as r,n as S,p as c,k as i,s as n,u as ie,as as C,x as h,v as f,B as L,z as ue,aL as de,aM as $,F as M,ay as ze,aN as Ie,aO as Qe,aP as De}from"./index.fb3f5ad5.js";import{u as qe,v as le,a as Ge,p as ne,b as He,c as Le,r as ce,s as Me,d as Ne}from"./position-engine.d6f8c41b.js";import{u as Re,a as We,b as Fe,c as Ue}from"./use-portal.7095234a.js";import{u as Ye,b as Je}from"./use-transition.97bade2a.js";import{b as Ke,c as Xe}from"./use-timeout.6c0c86b6.js";import{c as re}from"./selection.2af613b2.js";import{Q as Ze,u as ve,i as he,a as pe,b as fe,c as _e,d as et,_ as G}from"./QSpinnerHourglass.30ff9020.js";import{a as ye}from"./axios.a0958352.js";import{u as ge}from"./vue-i18n.runtime.f4bab15f.js";import{Q as tt}from"./QScrollArea.524d154d.js";import"./QResizeObserver.7833723c.js";import"./QScrollObserver.6863b12c.js";import"./touch.3df10340.js";import"./format.c860d4da.js";var me=Te({name:"QTooltip",inheritAttrs:!1,props:{...qe,...Re,...Ye,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:le},self:{type:String,default:"top middle",validator:le},offset:{type:Array,default:()=>[14,14],validator:Ge},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0}},emits:[...We],setup(a,{slots:u,emit:m,attrs:d}){let E,s;const p=Be(),{proxy:{$q:l}}=p,v=y(null),o=y(!1),b=V(()=>ne(a.anchor,l.lang.rtl)),w=V(()=>ne(a.self,l.lang.rtl)),A=V(()=>a.persistent!==!0),{registerTick:z,removeTick:Q}=Ke(),{registerTimeout:T}=Xe(),{transitionProps:D,transitionStyle:N}=Je(a),{localScrollTarget:q,changeScrollEvent:R,unconfigureScrollTarget:e}=He(a,Z),{anchorEl:t,canShow:_,anchorEvents:j}=Le({showing:o,configureAnchorEl:xe}),{show:be,hide:W}=Fe({showing:o,canShow:_,handleShow:$e,handleHide:ke,hideOnRouteChange:A,processOnMount:!0});Object.assign(j,{delayShow:Ce,delayHide:Ee});const{showPortal:J,hidePortal:K,renderPortal:Se}=Ue(p,v,we,"tooltip");if(l.platform.is.mobile===!0){const g={anchorEl:t,innerRef:v,onClickOutside(B){return W(B),B.target.classList.contains("q-dialog__backdrop")&&Ae(B),!0}},F=V(()=>a.modelValue===null&&a.persistent!==!0&&o.value===!0);H(F,B=>{(B===!0?Ne:ce)(g)}),te(()=>{ce(g)})}function $e(g){J(),z(()=>{s=new MutationObserver(()=>I()),s.observe(v.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),I(),Z()}),E===void 0&&(E=H(()=>l.screen.width+"|"+l.screen.height+"|"+a.self+"|"+a.anchor+"|"+l.lang.rtl,I)),T(()=>{J(!0),m("show",g)},a.transitionDuration)}function ke(g){Q(),K(),X(),T(()=>{K(!0),m("hide",g)},a.transitionDuration)}function X(){s!==void 0&&(s.disconnect(),s=void 0),E!==void 0&&(E(),E=void 0),e(),ae(j,"tooltipTemp")}function I(){Me({targetEl:v.value,offset:a.offset,anchorEl:t.value,anchorOrigin:b.value,selfOrigin:w.value,maxHeight:a.maxHeight,maxWidth:a.maxWidth})}function Ce(g){if(l.platform.is.mobile===!0){re(),document.body.classList.add("non-selectable");const F=t.value,B=["touchmove","touchcancel","touchend","click"].map(ee=>[F,ee,"delayHide","passiveCapture"]);se(j,"tooltipTemp",B)}T(()=>{be(g)},a.delay)}function Ee(g){l.platform.is.mobile===!0&&(ae(j,"tooltipTemp"),re(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),T(()=>{W(g)},a.hideDelay)}function xe(){if(a.noParentEvent===!0||t.value===null)return;const g=l.platform.is.mobile===!0?[[t.value,"touchstart","delayShow","passive"]]:[[t.value,"mouseenter","delayShow","passive"],[t.value,"mouseleave","delayHide","passive"]];se(j,"anchor",g)}function Z(){if(t.value!==null||a.scrollTarget!==void 0){q.value=Pe(t.value,a.scrollTarget);const g=a.noParentEvent===!0?I:W;R(q.value,g)}}function Oe(){return o.value===!0?oe("div",{...d,ref:v,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",d.class],style:[d.style,N.value],role:"tooltip"},Ve(u.default)):null}function we(){return oe(je,D.value,Oe)}return te(X),Object.assign(p.proxy,{updatePosition:I}),Se}});const at={},st={class:"column items-center",style:{height:"100%"}};function ot(a,u){return r(),S(P,{class:"no-shadow card-height"},{default:c(()=>[i(O,{style:{height:"100%"}},{default:c(()=>[n("div",st,[i(Ze,{color:"light-green",style:{height:"100%"},size:"3em"})])]),_:1})]),_:1})}var U=Y(at,[["render",ot],["__scopeId","data-v-787e5d5b"]]);const lt=()=>ye.get("/api/aws/resources/total"),nt=()=>ye.get("/api/iservcloud2/statistics/vms");const ct={class:"text-h6 mb-2"},rt={class:"row q-col-gutter-md"},it={class:"col-12 col-md-6 order-last order-md-first"},ut={class:"row items-center justify-center chart-height"},dt={class:"text-h5"},vt={class:"col-12 col-md-6 order-first order-md-last"},ht={class:"text-h6"},pt={class:"text-body1 text-bold"},ft={class:"text-h6"},_t={class:"text-body1 text-bold"},yt={class:"text-h6"},gt={class:"text-body1 text-bold"},mt={class:"text-h6"},bt={class:"text-body1 text-bold"},k="dashboard.iservcloud",St={__name:"iservcloud",setup(a){ve([he,pe,fe,_e,et]);const{t:u}=ge(),m=ie(),d=y({total:0,Active:0,Stopped:0,Others:0}),E=V(()=>({tooltip:{trigger:"item",formatter(o){return`
        <span class='echart-tooltip bg-echart-${o.color.replace("#","")}'></span>
        <span>${o.name}:${o.data.value}</span>
        `}},legend:{left:"center"},dataset:{source:[{value:d.value.Active,name:u(`${k}.Active`)},{value:d.value.Stopped,name:u(`${k}.Stopped`)},{value:d.value.Others,name:u(`${k}.other`)}]},series:[{type:"pie",radius:"55%",center:["50%","60%"]}]})),s=y(!1),p=y(!1),l=()=>{p.value=!0,nt().then(o=>{d.value.total=o.data.total,d.value.Active=o.data.statistics.Active,d.value.Stopped=o.data.statistics.Stopped,d.value.Others=o.data.statistics.Others,s.value=!1}).catch(()=>{d.value={total:0,Active:0,Stopped:0,Others:0},s.value=!0}).finally(()=>{p.value=!1})},v=()=>{m.push({path:"/iservcloud-resource"})};return l(),(o,b)=>(r(),C(M,null,[n("div",ct,h(f(u)(`${k}.title`)),1),n("div",rt,[n("div",it,[p.value?(r(),S(U,{key:1})):(r(),S(P,{key:0,class:"",bordered:""},{default:c(()=>[s.value?(r(),S(O,{key:1},{default:c(()=>[n("div",ut,[n("div",dt,h(f(u)(`${k}.noData`)),1)])]),_:1})):(r(),S(O,{key:0},{default:c(()=>[i(f(G),{option:E.value,class:"chart-height",resizable:!0,autoresize:""},null,8,["option"])]),_:1}))]),_:1}))]),n("div",vt,[p.value?$("",!0):(r(),S(P,{key:0,class:"mb-2",bordered:""},{default:c(()=>[i(O,null,{default:c(()=>[n("div",ht,[L(h(f(u)(`${k}.vmTotal`))+" ",1),i(ue,{class:"",flat:"",round:"",color:"",icon:"mdi-attachment",size:"16px",onClick:b[0]||(b[0]=de(w=>v(o.item),["stop"]))},{default:c(()=>[i(me,{class:"text-caption"},{default:c(()=>[L(h(f(u)(`${k}.tooltip`)),1)]),_:1})]),_:1})]),n("div",pt,h(d.value.total),1)]),_:1})]),_:1})),p.value?$("",!0):(r(),S(P,{key:1,class:"mb-2",bordered:""},{default:c(()=>[i(O,null,{default:c(()=>[n("div",ft,h(f(u)(`${k}.Active`)),1),n("div",_t,h(d.value.Active),1)]),_:1})]),_:1})),p.value?$("",!0):(r(),S(P,{key:2,class:"mb-2",bordered:""},{default:c(()=>[i(O,null,{default:c(()=>[n("div",yt,h(f(u)(`${k}.Stopped`)),1),n("div",gt,h(d.value.Stopped),1)]),_:1})]),_:1})),p.value?$("",!0):(r(),S(P,{key:3,class:"",bordered:""},{default:c(()=>[i(O,null,{default:c(()=>[n("div",mt,h(f(u)(`${k}.other`)),1),n("div",bt,h(d.value.Others),1)]),_:1})]),_:1})),p.value?(r(),S(U,{key:4})):$("",!0)])])],64))}};var $t=Y(St,[["__scopeId","data-v-89bdfee4"]]);const kt=a=>(Qe("data-v-1dfc195a"),a=a(),De(),a),Ct={class:"text-h6 mb-2"},Et={class:"row q-col-gutter-md"},xt=["onClick"],Ot={class:""},wt={class:"text-bold"},Tt={key:0,class:"col-12"},Pt={key:0,class:"row q-col-gutter-md"},jt={key:0,class:"col-12 col-md-6"},Bt={class:"row items-center justify-center text-h5 text-weight-bold"},Vt={key:1,class:"col-12 col-md-6"},At={class:"row items-center justify-center text-h5 text-weight-bold"},zt={key:2,class:"col-12"},It={class:"row items-center justify-center text-h5 text-weight-bold"},Qt=kt(()=>n("div",{class:"mt-5"},null,-1)),x="dashboard.aws",Dt={__name:"aws",setup(a){ve([he,pe,fe,_e]);const u=ie(),{t:m,te:d}=ge(),E=y(["EC2","EBS","VPC","Subnets","Security Groups"]),s=y("EC2"),p=y(!1),l=y({EC2:0,EBS:0,VPC:0,Subnets:0,"Security Groups":0}),v=y({state:{},type:{}}),o=y({state:{},type:{}}),b=y({state:{},type:{}}),w=y({state:{},type:{}}),A=y(null),z=y(null),Q=()=>{const e={state:[],type:[]};return s.value==="EC2"&&(Object.keys(v.value.state).length!==0&&Object.keys(v.value.state).forEach(t=>{const _=d(`${x}.${t}`)?m(`${x}.${t}`):t;e.state.push({value:v.value.state[t],name:_})}),Object.keys(v.value.type).length!==0&&Object.keys(v.value.type).forEach(t=>{e.type.push({value:v.value.type[t],name:t})})),s.value==="EBS"&&(Object.keys(o.value.state).length!==0&&Object.keys(o.value.state).forEach(t=>{const _=d(`${x}.${t}`)?m(`${x}.${t}`):t;e.state.push({value:o.value.state[t],name:_})}),Object.keys(o.value.type).length!==0&&Object.keys(o.value.type).forEach(t=>{e.type.push({value:o.value.type[t],name:t})})),s.value==="VPC"&&(Object.keys(b.value.state).length!==0&&Object.keys(b.value.state).forEach(t=>{e.state.push({value:b.value.state[t],name:t})}),e.type=[]),s.value==="Subnets"&&(Object.keys(w.value.state).length!==0&&Object.keys(w.value.state).forEach(t=>{e.state.push({value:w.value.state[t],name:t})}),e.type=[]),e},T=V(()=>({tooltip:{trigger:"item",formatter(e){return`
        <span class='echart-tooltip bg-echart-${e.color.replace("#","")}'></span>
        <span>${e.name}:${e.data.value}</span>
        `}},legend:{left:"center"},dataset:{source:Q().state},series:[{type:"pie",radius:"60%",center:["50%","50%"]}]})),D=V(()=>({tooltip:{trigger:"item",formatter(e){return`
        <span class='echart-tooltip bg-echart-${e.color.replace("#","")}'></span>
        <span>${e.name}:${e.data.value}</span>
        `}},legend:{left:"center"},dataset:{source:Q().type},series:[{type:"pie",radius:"60%",center:["50%","50%"]}]}));H(D,()=>{z.value!==null&&z.value.clear()}),H(T,()=>{A.value!==null&&A.value.clear()});const N=()=>{p.value=!0,lt().then(e=>{l.value.EC2=e.data.EC2.total,l.value.EBS=e.data.EBS.total,l.value.VPC=e.data.VPC.total,l.value.Subnets=e.data.Subnets.total,l.value["Security Groups"]=e.data.SecurityGroups.total,Object.keys(e.data.EC2.State).length!==0?v.value.state=e.data.EC2.State:v.value.state={},Object.keys(e.data.EC2.InstanceType).length!==0?v.value.type=e.data.EC2.InstanceType:v.value.type={},Object.keys(e.data.EBS.State).length!==0?o.value.state=e.data.EBS.State:o.value.state={},Object.keys(e.data.EBS.VolumeType).length!==0?o.value.type=e.data.EBS.VolumeType:o.value.type={},Object.keys(e.data.VPC.State).length!==0?b.value.state=e.data.VPC.State:b.value.state={},Object.keys(e.data.Subnets.State).length!==0?w.value.state=e.data.Subnets.State:w.value.state={}}).catch(()=>{l.value={EC2:0,EBS:0,VPC:0,Subnets:0,"Security Groups":0}}).finally(()=>{p.value=!1})},q=e=>{e!=="Security Groups"&&l.value[e]!==0&&(s.value=e)},R=e=>{e==="EC2"?u.push({path:"/aws-resource/ec2"}):e==="EBS"?u.push({path:"/aws-resource/ebs"}):e==="VPC"?u.push({path:"/aws-resource/vpc"}):e==="Subnets"?u.push({path:"/aws-resource/subnet"}):e==="Security Groups"&&u.push({path:"/aws-resource/security-group"})};return N(),(e,t)=>(r(),C(M,null,[n("div",Ct,h(f(m)(`${x}.title`)),1),n("div",Et,[(r(!0),C(M,null,ze(E.value,_=>(r(),C("div",{key:_,class:"col-6 col-md-4",onClick:j=>q(_)},[i(P,{class:Ie(["",[s.value===_?"bg-blue-3":"",_!=="Security Groups"?"":"cursor-not-allowed",l.value[_]!==0?"cursor-pointer":"cursor-not-allowed"]]),bordered:"",style:{height:"100%"}},{default:c(()=>[i(O,{class:"text-h6"},{default:c(()=>[n("div",Ot,[L(h(_)+" ",1),i(ue,{class:"",flat:"",round:"",color:"",icon:"mdi-attachment",size:"16px",onClick:de(j=>R(_),["stop"])},{default:c(()=>[i(me,{class:"text-caption"},{default:c(()=>[L(h(f(m)(`${x}.tooltip${_}`)),1)]),_:2},1024)]),_:2},1032,["onClick"])]),i(tt,{style:{"min-width":"100%",height:"40px"}},{default:c(()=>[n("div",wt,h(l.value[_]),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"])],8,xt))),128)),s.value==="EC2"&&l.value.EC2!==0||s.value==="EBS"&&l.value.EBS!==0||s.value==="VPC"&&l.value.VPC!==0||s.value==="Subnets"&&l.value.Subnets!==0?(r(),C("div",Tt,[i(P,{class:""},{default:c(()=>[i(O,null,{default:c(()=>[p.value?$("",!0):(r(),C("div",Pt,[s.value==="EC2"||s.value==="EBS"?(r(),C("div",jt,[n("div",Bt,h(f(m)(`${x}.state`)),1),i(f(G),{ref_key:"chartState",ref:A,option:T.value,class:"chart-height",resizable:!0,autoresize:""},null,8,["option"])])):$("",!0),s.value==="EC2"||s.value==="EBS"?(r(),C("div",Vt,[n("div",At,h(f(m)(`${x}.type`)),1),i(f(G),{ref_key:"chartType",ref:z,option:D.value,class:"chart-height",resizable:!0,autoresize:""},null,8,["option"])])):$("",!0),s.value==="VPC"||s.value==="Subnets"?(r(),C("div",zt,[n("div",It,h(f(m)(`${x}.state`)),1),i(f(G),{ref_key:"chartState",ref:A,option:T.value,class:"chart-height",resizable:!0,autoresize:""},null,8,["option"])])):$("",!0)])),p.value?(r(),S(U,{key:1})):$("",!0)]),_:1})]),_:1})])):$("",!0)]),Qt],64))}};var qt=Y(Dt,[["__scopeId","data-v-1dfc195a"]]);const aa={__name:"index",setup(a){return(u,m)=>(r(),C(M,null,[n("div",null,[i(qt)]),n("div",null,[i($t)])],64))}};export{aa as default};
