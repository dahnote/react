import{Q as P}from"./QInput.3afb05c8.js";import{ar as W,aw as G,r as v,f as g,o as J,q as n,as as p,k as l,p as o,s as d,x as m,cw as X,A as Y,z as $,F as k,ay as Z,av as U,v as R,B as z,n as b,aM as C,y as F,aO as ee,aP as ae}from"./index.fb3f5ad5.js";import{Q as te}from"./QCardActions.5afa793e.js";import{d as c,Q as le,a as oe}from"./QPopupProxy.c8c25096.js";import{Q as se}from"./QCardSection.4591ffd9.js";import{Q as re}from"./QCard.2b2d4094.js";import{Q as w}from"./QTd.417aa865.js";import{Q as N}from"./QTr.e4d3ff92.js";import{n as ne,Q as de,l as ie}from"./no-data.2e8b8955.js";import{C as ue}from"./ClosePopup.74952a98.js";import{b as me}from"./connection.6ce32872.js";import{f as ce}from"./table-filter.7923a56f.js";import{a as fe}from"./format-time.e227a64b.js";import{u as pe}from"./vue-i18n.runtime.f4bab15f.js";import"./use-timeout.6c0c86b6.js";import"./uid.42677368.js";import"./use-transition.97bade2a.js";import"./use-cache.b0833c75.js";import"./format.c860d4da.js";import"./QDialog.fc5c29ed.js";import"./QSeparator.9cedb50e.js";import"./use-portal.7095234a.js";import"./focusout.c6764dff.js";import"./QMenu.0d0ddedc.js";import"./position-engine.d6f8c41b.js";import"./selection.2af613b2.js";import"./QList.e0faa10e.js";import"./QSelect.650daa0f.js";import"./rtl.b51694b1.js";import"./QInnerLoading.4e21fbf1.js";import"./axios.a0958352.js";const ve=y=>(ee("data-v-7cfd4ef9"),y=y(),ae(),y),be={class:"row q-col-gutter-md"},ye={class:"col-12 col-sm-4"},_e={class:"col-12 col-sm-4"},he={class:"col-12 col-sm-8 row justify-center"},ge=ve(()=>d("div",{class:"null-h52-block"},null,-1)),$e={key:0,class:"text-green-8"},we={key:1,class:"text-grey-8"},De={class:"text-left text-body1"},Ye={class:"text-weight-bold"},ke={key:0,class:"ma-10 pa-10"},r="connection.log",Ce={__name:"index",setup(y){const{t:i,te:x}=pe(),j=G(),f=v(!0),q=g(()=>{const e=[{name:"expand",align:"left",label:"",field:"expand",headerClasses:"table-header",classes:"table-body",headerStyle:"width: 20px"}];return D.value==="aws"?e.push({name:"resource_name",align:"left",label:i(`${r}.accesskey`),field:"resource_name",headerClasses:"table-header",classes:"table-body"}):e.push({name:"resource_name",align:"left",label:i(`${r}.account`),field:"resource_name",headerClasses:"table-header",classes:"table-body"}),e.push({name:"type",align:"left",label:i(`${r}.type`),field:"formatType",headerClasses:"table-header",classes:"table-body",sortable:!0},{name:"state",align:"left",label:i(`${r}.state`),field:"formatState",headerClasses:"table-header",classes:"table-body",sortable:!0},{name:"account",align:"left",label:i(`${r}.actionUser`),field:"action_username",headerClasses:"table-header",classes:"table-body",sortable:!0},{name:"update_time",align:"left",label:i(`${r}.updateTime`),field:"formatUpdateTime",headerClasses:"table-header",classes:"table-body",sortable:!0,filter:!1}),e}),A={rowsPerPage:10,sortBy:"update_time",descending:!0},K=[0,10,20],_=v(""),Q=v(""),M=Date.now(),S=c.formatDate(c.subtractFromDate(M,{days:7}),"YYYY/MM/DD"),V=c.formatDate(M,"YYYY/MM/DD"),s=v({from:S,to:V}),T=()=>{Q.value=_.value,u.value=[],I()},E=()=>{_.value="",s.value={from:S,to:V}},B=g(()=>s.value!==null?typeof s.value=="object"?`${s.value.from}~${s.value.to}`:`${s.value}~${s.value}`:""),H=(e,t,a)=>ce(a,e,t),L=g(()=>(u.value.forEach((e,t)=>{u.value[t].formatType=x(`${r}.${e.action}`)?i(`${r}.${e.action}`):e.action,u.value[t].formatState=x(`${r}.${e.state}`)?i(`${r}.${e.state}`):e.state,u.value[t].formatUpdateTime=fe(e.update_time)}),u.value)),u=v([]),I=()=>{f.value=!0;let e="";D.value==="aws"?e="/aws_connection":D.value==="iServCloud"&&(e="/iservcloud_connection"),s.value!==null&&(typeof s.value=="object"?e+=`?date_from=${c.formatDate(s.value.from,"YYYY-MM-DD")}&date_end=${c.formatDate(s.value.to,"YYYY-MM-DD")}`:e+=`?date_from=${c.formatDate(s.value,"YYYY-MM-DD")}&date_end=${c.formatDate(s.value,"YYYY-MM-DD")}`),me(e).then(t=>{u.value=t.data}).finally(()=>{f.value=!1})},O=()=>!!(u.value.length===0&&f.value),D=g(()=>j.path==="/aws-resource/connection-log"?"aws":"iServCloud");return J(()=>{I()}),(e,t)=>(n(),p(k,null,[l(re,{class:"bg-grey-11 shadow-1 mb-4 text-weight-medium"},{default:o(()=>[l(se,null,{default:o(()=>[d("div",be,[d("div",ye,[d("div",null,m(e.$t("general.table.keyword")),1),l(P,{dense:"",placeholder:e.$t("general.table.enterKeyword"),modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=a=>_.value=a),onKeyup:t[1]||(t[1]=X(a=>T(),["enter"]))},null,8,["placeholder","modelValue"])]),d("div",_e,[d("div",null,m(e.$t("general.table.dateRange")),1),l(P,{dense:"",readonly:"",class:"cursor-pointer",modelValue:B.value,"onUpdate:modelValue":t[3]||(t[3]=a=>B.value=a)},{default:o(()=>[l(le,{"transition-show":"scale","transition-hide":"scale",class:"s123"},{default:o(()=>[l(oe,{minimal:"",modelValue:s.value,"onUpdate:modelValue":t[2]||(t[2]=a=>s.value=a),mask:"YYYY/MM/DD",range:""},{default:o(()=>[l(te,{class:"q-pa-none",align:"around"},{default:o(()=>[Y(l($,{color:"secondary",label:e.$t("general.btn.close")},null,8,["label"]),[[ue]])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),d("div",he,[l($,{class:"mr-2",color:"primary",icon:"mdi-magnify",label:e.$t("general.btn.search"),onClick:t[4]||(t[4]=a=>T()),rounded:"","no-caps":""},null,8,["label"]),l($,{color:"secondary",icon:"mdi-eraser",label:e.$t("general.btn.reset"),onClick:t[5]||(t[5]=a=>E()),rounded:"","no-caps":""},null,8,["label"])])])]),_:1})]),_:1}),ge,l(de,{"card-class":"customer-table",rows:L.value,columns:q.value,"row-key":"id",loading:f.value,"loading-label":" ","hide-bottom":O(),pagination:A,"rows-per-page-options":K,filter:Q.value,"filter-method":H},{body:o(a=>[l(N,{props:a},{default:o(()=>[(n(!0),p(k,null,Z(a.cols,h=>(n(),p(k,{key:h.name},[h.name==="expand"?(n(),b(w,{key:0,class:"table-body"},{default:o(()=>[a.row.state==="failed"?(n(),b($,{key:0,size:"sm",color:"accent",round:"",dense:"",onClick:xe=>a.expand=!a.expand,icon:a.expand?"remove":"add"},null,8,["onClick","icon"])):C("",!0)]),_:2},1024)):h.name==="state"?(n(),b(w,{key:1,class:"table-body"},{default:o(()=>[a.row.state==="completed"?(n(),p("div",$e,[l(F,{size:"24px",name:"mdi-check-circle-outline"}),d("span",null,m(a.row.formatState),1)])):(n(),p("div",we,[l(F,{size:"24px",name:"mdi-minus-circle-outline"}),d("span",null,m(a.row.formatState),1)]))]),_:2},1024)):(n(),b(w,{key:2,class:"table-body"},{default:o(()=>[z(m(h.value),1)]),_:2},1024))],64))),128))]),_:2},1032,["props"]),Y(l(N,{props:a},{default:o(()=>[l(w,{colspan:"100%"},{default:o(()=>[d("div",De,[d("span",Ye,m(R(i)(`${r}.reason`))+": ",1),z(" "+m(R(i)(`${r}.error`)),1)])]),_:1})]),_:2},1032,["props"]),[[U,a.expand]])]),loading:o(()=>[u.value.length===0?Y((n(),b(ie,{key:0},null,512)),[[U,f.value]]):C("",!0)]),"bottom-row":o(()=>[f.value&&u.value.length===0?(n(),p("div",ke)):C("",!0)]),"no-data":o(()=>[l(ne)]),_:1},8,["rows","columns","loading","hide-bottom","filter"])],64))}};var sa=W(Ce,[["__scopeId","data-v-7cfd4ef9"]]);export{sa as default};
