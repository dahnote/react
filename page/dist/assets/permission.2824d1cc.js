import{d as a,P as c}from"./index.fb3f5ad5.js";import{a as t,r as h}from"./axios.a0958352.js";const g=s=>t.post("/api/token/pair",s),l=()=>t.get("/api/token/verify"),v=s=>t.post("/api/user/password",s);function i(s,e,n){const o=[];return s.forEach(u=>{const r={...u};m(e,r)&&(r.children&&(r.children=i(r.children,e)),o.push(r))}),o}function m(s,e,n){return!!e.meta.roles.includes(s)}const p=a("permission",{state:()=>({routes:[],role:"",account:"",userid:""}),getters:{},actions:{async addRoute(s){let e=[];return e=i(s,this.role),this.routes=[],this.routes.push(e),e},async checkToken(s){try{const e=await l();return e.data.is_superuser?this.role="supervisor":this.role="client",this.account=e.data.username,this.userid=e.data.id,e}catch{return this.routes=[],this.role="",h(),"error"}},async logout(){this.routes.length!==0&&this.routes[0].forEach(e=>{this.router.removeRoute(e.name)}),c.remove("is3"),p().$reset(),this.router.push("/login")}}});export{g as l,v as r,p as u};
